yabai -m signal --add event=dock_did_restart action="sudo yabai --load-sa"

sudo yabai --load-sa

# Debug
yabai -m config debug_output off

# 鼠标交互：保持“点击才切焦点”（禁用 hover/鼠标跟随焦点）
yabai -m config focus_follows_mouse off
yabai -m config mouse_follows_focus off
# 强制“获得焦点=置前”，避免 float 空间点击后只聚焦不前置
yabai -m signal --add event=window_focused action="yabai -m window --raise"

yabai -m config top_padding    8
yabai -m config bottom_padding 8
yabai -m config left_padding   8
yabai -m config right_padding  8
yabai -m config window_gap     8

# Focus border (JankyBorders)
# Loads ~/.config/borders/bordersrc when started without args.
# Kill any existing instance to avoid duplicates.
pkill -x borders 2>/dev/null
borders >/dev/null 2>&1 &

yabai -m rule --add app="^iPhone Mirroring$" manage=off
yabai -m rule --add app="^System Settings$" manage=off
yabai -m rule --add app="^System Preferences$" manage=off
yabai -m rule --add app="^Installer$" manage=off
yabai -m rule --add app="^Install macOS.*$" manage=off

# --- Fixed app -> space placement ---
# Prevent cross-space launches from scrambling your workspace.
yabai -m rule --add app="^kitty$" space=1 manage=on
yabai -m rule --add app="^(ChatGPT|ChatGPT Desktop)$" space=2
yabai -m rule --add app="^(WeChat|微信)$" space=3

# Space 3 should behave as float workspace.
yabai -m config --space 1 layout bsp
yabai -m config --space 2 layout bsp
yabai -m config --space 3 layout float

# Auto re-arrange on app lifecycle (idempotent script)
yabai -m signal --add event=application_launched action="$HOME/dotfiles/scripts/yabai_rerange_spaces.sh"
yabai -m signal --add event=application_terminated action="$HOME/dotfiles/scripts/yabai_rerange_spaces.sh"
yabai -m config external_bar all:30:0


