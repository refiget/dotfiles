# ============================================================
# Cursor shape for vi-mode
#   insert/main: bar
#   vicmd: block
# ============================================================
[[ -o interactive ]] || return

__cursor_block() { print -n -- $'\e[2 q' }
__cursor_bar()   { print -n -- $'\e[6 q' }

function zle-keymap-select {
  case ${KEYMAP:-main} in
    vicmd) __cursor_block ;;
    *) __cursor_bar ;;
  esac
  zle reset-prompt
}

function zle-line-init {
  __cursor_bar
  zle reset-prompt
}

function zle-line-finish {
  __cursor_bar
}

zle -N zle-keymap-select
zle -N zle-line-init
zle -N zle-line-finish
