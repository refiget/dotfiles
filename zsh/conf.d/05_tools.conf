# ============================================================
# External Tools (Yazi, Zoxide, FZF, NVM)
# ============================================================

# Yazi
y() {
  local tmp="$(mktemp)"
  yazi --cwd-file="$tmp" "$@"
  [[ -f "$tmp" ]] && cd "$(cat "$tmp")" && rm -f "$tmp"
}

# Zoxide
if command -v zoxide >/dev/null 2>&1; then
  eval "$(zoxide init zsh)"
  alias za='zoxide add $(pwd)'
  alias zl='zoxide query -l'
  alias zf='zoxide query'
fi

# FZF
[ -f ~/.fzf.zsh ] && source ~/.fzf.zsh
[ -f /usr/share/doc/fzf/examples/key-bindings.zsh ] && source /usr/share/doc/fzf/examples/key-bindings.zsh
[ -f /usr/share/doc/fzf/examples/completion.zsh ] && source /usr/share/doc/fzf/examples/completion.zsh
export FZF_IGNORE_FILE="$HOME/.ignore"
export FZF_DEFAULT_COMMAND='fd --type f --hidden --follow --strip-cwd-prefix --ignore-file "$FZF_IGNORE_FILE" --exclude .git'
export FZF_CTRL_T_COMMAND="$FZF_DEFAULT_COMMAND"
export FZF_ALT_C_COMMAND='fd --type d --hidden --follow --strip-cwd-prefix --ignore-file "$FZF_IGNORE_FILE" --exclude .git'

# Lazy NVM
export NVM_DIR="$HOME/.nvm"
lazy_nvm() {
  unset -f node npm nvm
  [[ -s "$NVM_DIR/nvm.sh" ]] && source "$NVM_DIR/nvm.sh"
}
node() { lazy_nvm; node "$@"; }
npm() { lazy_nvm; npm "$@"; }
nvm() { lazy_nvm; nvm "$@"; }
