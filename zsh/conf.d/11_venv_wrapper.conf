# ============================================================
# Minimal Python venv helpers
#   mkvenv <name>  -> create ~/venvs/<name>
#   venv <name>    -> activate ~/venvs/<name>
# ============================================================

# One place to change interpreter (default: python3.11)
export VENV_PYTHON="${VENV_PYTHON:-python3.11}"
export VENV_HOME="$HOME/venvs"

[[ -d "$VENV_HOME" ]] || mkdir -p "$VENV_HOME"

mkvenv() {
  if [[ $# -ne 1 ]]; then
    echo "Usage: mkvenv <name>"
    return 1
  fi

  local name="$1"
  local venv_dir="$VENV_HOME/$name"

  if [[ -d "$venv_dir" && -f "$venv_dir/bin/activate" ]]; then
    echo "mkvenv: already exists: $venv_dir"
    return 0
  fi

  "$VENV_PYTHON" -m venv "$venv_dir" || return $?
  echo "mkvenv: created $venv_dir (python: $VENV_PYTHON)"
}

venv() {
  if [[ $# -ne 1 ]]; then
    echo "Usage: venv <name>"
    return 1
  fi

  local name="$1"
  local venv_dir="$VENV_HOME/$name"
  local activate="$venv_dir/bin/activate"

  if [[ ! -f "$activate" ]]; then
    echo "venv: not found: $venv_dir"
    echo "Try: mkvenv $name"
    return 1
  fi

  source "$activate"
}
