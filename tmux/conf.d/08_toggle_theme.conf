# sync input toggle
bind C-g if-shell '[[ $(tmux showw synchronize-panes | cut -d\  -f2) == "on" ]]' \
'setw synchronize-panes off; set -g pane-border-style fg=#{?#{!=:#{environ:TMUX_THEME_COLOR},},#{environ:TMUX_THEME_COLOR},#b294bb}' \
'setw synchronize-panes on; set -g pane-border-style fg=red'

# local mac theme
run-shell "~/.config/tmux/scripts/update_theme_color.sh"
setw -g pane-border-status off
set -g pane-border-style fg=colour244

set -g status-style "bg=default,fg=#c5c8c6"
set -g status-justify 'centre'
set -g status-left-length 90
set -g status-right-length 140
run-shell -b '~/.config/tmux/scripts/pomo_refresh_interval.sh'

set -g @tab_bg "#1e1e2e"
set -g @tab_text "#cdd6f4"
set -g @tab_subtext "#a6adc8"
set -g @tab_overlay "#6c7086"

setw -g window-status-separator '#[fg=#313244] │ #[default]'
set -g window-status-style "bg=default"
set -g window-status-current-style "bg=default"
set -g window-status-last-style 'fg=#{@tab_text},bg=#{@tab_bg}'
setw -g window-status-format '#[fg=#{@tab_overlay}]  #I:#[fg=#{@tab_subtext}]#{=16:#{window_name}}#{?window_activity_flag,#[fg=#ffb86c] •#[fg=#{@tab_subtext}],}#{?window_bell_flag,#[fg=#ff5555,bold] !#[fg=#{@tab_subtext}],}#{?window_zoomed_flag,#[fg=#{@theme_color},bold] Z#[fg=#{@tab_subtext}],}  '
setw -g window-status-current-format '#[fg=#{@tab_text},bg=#{@tab_bg}]#[bold]▏  ▸ #[fg=#{@tab_overlay},bg=#{@tab_bg}]#I:#[fg=#{@tab_text},bg=#{@tab_bg}]#{=18:#{window_name}}#{?window_active,,#{?window_activity_flag,#[fg=#ffb86c,bg=#{@tab_bg}] •,}}#{?window_active,,#{?window_bell_flag,#[fg=#ff5555,bg=#{@tab_bg}]#[bold] !,}}#{?window_zoomed_flag,#[fg=#{@tab_text},bg=#{@tab_bg}]#[bold] Z,}  ▕#[default]'

setw -g window-status-activity-style "fg=#ffb86c"
setw -g window-status-bell-style "fg=#ff5555,bold"
set-option -g status-left "#(~/.config/tmux/tmux-status/left.sh)  "
set-option -g status-right "#(~/.config/tmux/tmux-status/right.sh)"

bind-key t run-shell -b 'token="$(date +%s)"; tmux set -g @pomo_token "$token"; tmux set -g @pomo_until_epoch "$(( token + 1800 ))"; ~/.config/tmux/scripts/pomo_refresh_interval.sh; tmux refresh-client -S; (sleep 1800; current="$(tmux show -gqv @pomo_token 2>/dev/null || true)"; if [ "$current" = "$token" ]; then tmux set -gu @pomo_until_epoch >/dev/null 2>&1 || true; tmux set -gu @pomo_token >/dev/null 2>&1 || true; ~/.config/tmux/scripts/pomo_refresh_interval.sh; tmux refresh-client -S; osascript -e '"'"'tell application "System Events" to keystroke "z" using {command down, control down, option down, shift down}'"'"'; fi) >/dev/null 2>&1 &'
bind-key T run-shell -b 'tmux set -gu @pomo_until_epoch >/dev/null 2>&1 || true; tmux set -gu @pomo_token >/dev/null 2>&1 || true; ~/.config/tmux/scripts/pomo_refresh_interval.sh; tmux refresh-client -S'
